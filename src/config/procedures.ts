// src/config/procedures.ts

export interface ProcedureItem {
  id: string;
  code: string;
  name: string;
  nameRo?: string; // Romanian name
  category: ProcedureCategory;
  description?: string;
  defaultCost: number; // √Æn RON
  insuranceCost?: number;
  estimatedDurationMinutes: number;
  requiresAnesthesia?: boolean;
  commonlyUsed?: boolean;
  surfaces?: boolean; // dacƒÉ procedura poate fi aplicatƒÉ pe suprafe»õe
  perTooth?: boolean; // dacƒÉ pre»õul e per dinte
  tags?: string[];
}

export enum ProcedureCategory {
  DIAGNOSTIC = 'DIAGNOSTIC',
  PREVENTIVE = 'PREVENTIVE',
  RESTORATIVE = 'RESTORATIVE',
  ENDODONTICS = 'ENDODONTICS',
  ORAL_SURGERY = 'ORAL_SURGERY',
  PERIODONTICS = 'PERIODONTICS',
  ORTHODONTICS = 'ORTHODONTICS',
  PROSTHODONTICS = 'PROSTHODONTICS',
  COSMETIC = 'COSMETIC',
  EMERGENCY = 'EMERGENCY',
  OTHER = 'OTHER'
}

export const categoryInfo = {
  [ProcedureCategory.DIAGNOSTIC]: {
    label: 'Diagnostic',
    labelRo: 'Diagnostic',
    icon: 'üîç',
    color: 'blue',
    description: 'ExaminƒÉri »ôi investiga»õii'
  },
  [ProcedureCategory.PREVENTIVE]: {
    label: 'Preventive',
    labelRo: 'Preventiv',
    icon: 'üõ°Ô∏è',
    color: 'green',
    description: 'Tratamente preventive »ôi profilactice'
  },
  [ProcedureCategory.RESTORATIVE]: {
    label: 'Restorative',
    labelRo: 'Restaurativ',
    icon: 'ü¶∑',
    color: 'orange',
    description: 'Obtura»õii »ôi restaurƒÉri'
  },
  [ProcedureCategory.ENDODONTICS]: {
    label: 'Endodontics',
    labelRo: 'Endodon»õie',
    icon: 'üíâ',
    color: 'red',
    description: 'Tratamente de canal'
  },
  [ProcedureCategory.ORAL_SURGERY]: {
    label: 'Oral Surgery',
    labelRo: 'Chirurgie OralƒÉ',
    icon: 'üî™',
    color: 'purple',
    description: 'Extrac»õii »ôi interven»õii chirurgicale'
  },
  [ProcedureCategory.PERIODONTICS]: {
    label: 'Periodontics',
    labelRo: 'Parodontologie',
    icon: 'ü©∫',
    color: 'pink',
    description: 'Tratamente gingivale »ôi parodontale'
  },
  [ProcedureCategory.ORTHODONTICS]: {
    label: 'Orthodontics',
    labelRo: 'Ortodon»õie',
    icon: 'üéØ',
    color: 'teal',
    description: 'Aparate dentare »ôi aliniere'
  },
  [ProcedureCategory.PROSTHODONTICS]: {
    label: 'Prosthodontics',
    labelRo: 'ProteticƒÉ',
    icon: 'üëë',
    color: 'indigo',
    description: 'Coroane, pun»õi »ôi proteze'
  },
  [ProcedureCategory.COSMETIC]: {
    label: 'Cosmetic',
    labelRo: 'Cosmetic',
    icon: '‚ú®',
    color: 'yellow',
    description: 'Tratamente estetice'
  },
  [ProcedureCategory.EMERGENCY]: {
    label: 'Emergency',
    labelRo: 'Urgen»õƒÉ',
    icon: 'üö®',
    color: 'red',
    description: 'Tratamente de urgen»õƒÉ'
  },
  [ProcedureCategory.OTHER]: {
    label: 'Other',
    labelRo: 'Altele',
    icon: 'üìã',
    color: 'gray',
    description: 'Alte proceduri'
  }
};

// Seed data - Common dental procedures in Romania
export const defaultProcedures: ProcedureItem[] = [
  // DIAGNOSTIC
  {
    id: 'proc-001',
    code: 'D0120',
    name: 'Periodic Oral Evaluation',
    nameRo: 'Consulta»õie periodicƒÉ',
    category: ProcedureCategory.DIAGNOSTIC,
    description: 'Examinare oralƒÉ periodicƒÉ pentru pacient existent',
    defaultCost: 100,
    insuranceCost: 50,
    estimatedDurationMinutes: 20,
    commonlyUsed: true,
    tags: ['consulta»õie', 'control']
  },
  {
    id: 'proc-002',
    code: 'D0140',
    name: 'Emergency Oral Evaluation',
    nameRo: 'Consulta»õie de urgen»õƒÉ',
    category: ProcedureCategory.DIAGNOSTIC,
    description: 'Evaluare oralƒÉ de urgen»õƒÉ - problemƒÉ focalizatƒÉ',
    defaultCost: 150,
    insuranceCost: 75,
    estimatedDurationMinutes: 30,
    commonlyUsed: true,
    tags: ['urgen»õƒÉ', 'durere']
  },
  {
    id: 'proc-003',
    code: 'D0210',
    name: 'Complete X-ray Series',
    nameRo: 'Radiografie panoramicƒÉ',
    category: ProcedureCategory.DIAGNOSTIC,
    description: 'Serie completƒÉ radiograficƒÉ intraoralƒÉ',
    defaultCost: 200,
    insuranceCost: 150,
    estimatedDurationMinutes: 15,
    commonlyUsed: true,
    tags: ['radiografie', 'panoramic']
  },
  {
    id: 'proc-004',
    code: 'D0220',
    name: 'Periapical X-ray',
    nameRo: 'Radiografie periapicalƒÉ',
    category: ProcedureCategory.DIAGNOSTIC,
    description: 'Prima radiografie periapicalƒÉ',
    defaultCost: 50,
    insuranceCost: 30,
    estimatedDurationMinutes: 5,
    commonlyUsed: true,
    perTooth: true,
    tags: ['radiografie', 'retroalveolar']
  },

  // PREVENTIVE
  {
    id: 'proc-005',
    code: 'D1110',
    name: 'Prophylaxis - Adult',
    nameRo: 'Detartraj »ôi periaj profesional',
    category: ProcedureCategory.PREVENTIVE,
    description: 'CurƒÉ»õare profesionalƒÉ pentru adul»õi',
    defaultCost: 250,
    insuranceCost: 150,
    estimatedDurationMinutes: 45,
    commonlyUsed: true,
    tags: ['detartraj', 'igienizare', 'profilaxie']
  },
  {
    id: 'proc-006',
    code: 'D1206',
    name: 'Fluoride Varnish',
    nameRo: 'Fluoridare topicƒÉ',
    category: ProcedureCategory.PREVENTIVE,
    description: 'Aplicare lac cu fluor',
    defaultCost: 100,
    insuranceCost: 50,
    estimatedDurationMinutes: 10,
    tags: ['fluor', 'preven»õie']
  },
  {
    id: 'proc-007',
    code: 'D1351',
    name: 'Sealant',
    nameRo: 'Sigilare',
    category: ProcedureCategory.PREVENTIVE,
    description: 'Sigilare »ôan»õuri »ôi fisuri - per dinte',
    defaultCost: 80,
    insuranceCost: 40,
    estimatedDurationMinutes: 15,
    perTooth: true,
    tags: ['sigilare', 'preven»õie']
  },

  // RESTORATIVE
  {
    id: 'proc-008',
    code: 'D2330',
    name: 'Composite - One Surface',
    nameRo: 'Obtura»õie compozit - 1 suprafa»õƒÉ',
    category: ProcedureCategory.RESTORATIVE,
    description: 'Obtura»õie compozit pe o suprafa»õƒÉ',
    defaultCost: 200,
    insuranceCost: 100,
    estimatedDurationMinutes: 30,
    requiresAnesthesia: true,
    commonlyUsed: true,
    surfaces: true,
    perTooth: true,
    tags: ['obtura»õie', 'plombƒÉ', 'compozit']
  },
  {
    id: 'proc-009',
    code: 'D2331',
    name: 'Composite - Two Surfaces',
    nameRo: 'Obtura»õie compozit - 2 suprafe»õe',
    category: ProcedureCategory.RESTORATIVE,
    description: 'Obtura»õie compozit pe douƒÉ suprafe»õe',
    defaultCost: 250,
    insuranceCost: 125,
    estimatedDurationMinutes: 40,
    requiresAnesthesia: true,
    commonlyUsed: true,
    surfaces: true,
    perTooth: true,
    tags: ['obtura»õie', 'plombƒÉ', 'compozit']
  },
  {
    id: 'proc-010',
    code: 'D2332',
    name: 'Composite - Three Surfaces',
    nameRo: 'Obtura»õie compozit - 3 suprafe»õe',
    category: ProcedureCategory.RESTORATIVE,
    description: 'Obtura»õie compozit pe trei suprafe»õe',
    defaultCost: 300,
    insuranceCost: 150,
    estimatedDurationMinutes: 50,
    requiresAnesthesia: true,
    commonlyUsed: true,
    surfaces: true,
    perTooth: true,
    tags: ['obtura»õie', 'plombƒÉ', 'compozit']
  },
  {
    id: 'proc-011',
    code: 'D2335',
    name: 'Composite - Four+ Surfaces',
    nameRo: 'Obtura»õie compozit - 4+ suprafe»õe',
    category: ProcedureCategory.RESTORATIVE,
    description: 'Obtura»õie compozit pe patru sau mai multe suprafe»õe',
    defaultCost: 350,
    insuranceCost: 175,
    estimatedDurationMinutes: 60,
    requiresAnesthesia: true,
    surfaces: true,
    perTooth: true,
    tags: ['obtura»õie', 'plombƒÉ', 'compozit', 'reconstruc»õie']
  },

  // ENDODONTICS
  {
    id: 'proc-012',
    code: 'D3310',
    name: 'Root Canal - Anterior',
    nameRo: 'Tratament endodontic - dinte anterior',
    category: ProcedureCategory.ENDODONTICS,
    description: 'Tratament de canal pentru dinte anterior (incisiv/canin)',
    defaultCost: 800,
    insuranceCost: 400,
    estimatedDurationMinutes: 60,
    requiresAnesthesia: true,
    commonlyUsed: true,
    perTooth: true,
    tags: ['canal', 'endodon»õie', 'devitalizare']
  },
  {
    id: 'proc-013',
    code: 'D3320',
    name: 'Root Canal - Premolar',
    nameRo: 'Tratament endodontic - premolar',
    category: ProcedureCategory.ENDODONTICS,
    description: 'Tratament de canal pentru premolar',
    defaultCost: 1000,
    insuranceCost: 500,
    estimatedDurationMinutes: 90,
    requiresAnesthesia: true,
    commonlyUsed: true,
    perTooth: true,
    tags: ['canal', 'endodon»õie', 'devitalizare']
  },
  {
    id: 'proc-014',
    code: 'D3330',
    name: 'Root Canal - Molar',
    nameRo: 'Tratament endodontic - molar',
    category: ProcedureCategory.ENDODONTICS,
    description: 'Tratament de canal pentru molar',
    defaultCost: 1200,
    insuranceCost: 600,
    estimatedDurationMinutes: 120,
    requiresAnesthesia: true,
    commonlyUsed: true,
    perTooth: true,
    tags: ['canal', 'endodon»õie', 'devitalizare']
  },

  // ORAL SURGERY
  {
    id: 'proc-015',
    code: 'D7140',
    name: 'Simple Extraction',
    nameRo: 'Extrac»õie simplƒÉ',
    category: ProcedureCategory.ORAL_SURGERY,
    description: 'Extrac»õie dinte erupt',
    defaultCost: 200,
    insuranceCost: 100,
    estimatedDurationMinutes: 30,
    requiresAnesthesia: true,
    commonlyUsed: true,
    perTooth: true,
    tags: ['extrac»õie', 'scoatere']
  },
  {
    id: 'proc-016',
    code: 'D7210',
    name: 'Surgical Extraction',
    nameRo: 'Extrac»õie chirurgicalƒÉ',
    category: ProcedureCategory.ORAL_SURGERY,
    description: 'Extrac»õie chirurgicalƒÉ cu lambou',
    defaultCost: 400,
    insuranceCost: 200,
    estimatedDurationMinutes: 45,
    requiresAnesthesia: true,
    perTooth: true,
    tags: ['extrac»õie', 'chirurgie']
  },
  {
    id: 'proc-017',
    code: 'D7240',
    name: 'Wisdom Tooth Extraction',
    nameRo: 'Extrac»õie molari de minte',
    category: ProcedureCategory.ORAL_SURGERY,
    description: 'Extrac»õie molar de minte inclus',
    defaultCost: 500,
    insuranceCost: 250,
    estimatedDurationMinutes: 60,
    requiresAnesthesia: true,
    commonlyUsed: true,
    perTooth: true,
    tags: ['molar', 'minte', 'extrac»õie']
  },

  // PERIODONTICS
  {
    id: 'proc-018',
    code: 'D4341',
    name: 'Scaling and Root Planing',
    nameRo: 'Chiuretaj »ôi surfasaj radicular',
    category: ProcedureCategory.PERIODONTICS,
    description: 'Chiuretaj subgingival per cadran',
    defaultCost: 300,
    insuranceCost: 150,
    estimatedDurationMinutes: 45,
    requiresAnesthesia: true,
    tags: ['parodontologie', 'chiuretaj']
  },
  {
    id: 'proc-019',
    code: 'D4910',
    name: 'Periodontal Maintenance',
    nameRo: '√éntre»õinere parodontalƒÉ',
    category: ProcedureCategory.PERIODONTICS,
    description: 'Proceduri de √Æntre»õinere parodontalƒÉ',
    defaultCost: 250,
    insuranceCost: 125,
    estimatedDurationMinutes: 60,
    tags: ['parodontologie', '√Æntre»õinere']
  },

  // PROSTHODONTICS
  {
    id: 'proc-020',
    code: 'D2740',
    name: 'Porcelain Crown',
    nameRo: 'CoroanƒÉ ceramicƒÉ',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'CoroanƒÉ integral ceramicƒÉ',
    defaultCost: 1500,
    insuranceCost: 750,
    estimatedDurationMinutes: 60,
    commonlyUsed: true,
    perTooth: true,
    tags: ['coroanƒÉ', 'ceramicƒÉ', 'proteticƒÉ']
  },
  {
    id: 'proc-021',
    code: 'D2750',
    name: 'PFM Crown',
    nameRo: 'CoroanƒÉ metalo-ceramicƒÉ',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'CoroanƒÉ metalo-ceramicƒÉ',
    defaultCost: 1200,
    insuranceCost: 600,
    estimatedDurationMinutes: 60,
    commonlyUsed: true,
    perTooth: true,
    tags: ['coroanƒÉ', 'metalo-ceramicƒÉ', 'proteticƒÉ']
  },
  {
    id: 'proc-022',
    code: 'D2950',
    name: 'Core Buildup',
    nameRo: 'Reconstituire pivot',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'Reconstituire de bont cu pivot',
    defaultCost: 300,
    insuranceCost: 150,
    estimatedDurationMinutes: 30,
    perTooth: true,
    tags: ['pivot', 'reconstituire']
  },
  {
    id: 'proc-023',
    code: 'D6010',
    name: 'Implant',
    nameRo: 'Implant dentar',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'Inserare implant dentar endosos',
    defaultCost: 3000,
    insuranceCost: 0,
    estimatedDurationMinutes: 90,
    commonlyUsed: true,
    perTooth: true,
    tags: ['implant', 'chirurgie', 'proteticƒÉ']
  },
  {
    id: 'proc-024',
    code: 'D6066',
    name: 'Implant Crown',
    nameRo: 'CoroanƒÉ pe implant',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'CoroanƒÉ ceramicƒÉ pe implant',
    defaultCost: 1800,
    insuranceCost: 0,
    estimatedDurationMinutes: 45,
    perTooth: true,
    tags: ['coroanƒÉ', 'implant', 'proteticƒÉ']
  },
  {
    id: 'proc-025',
    code: 'D6240',
    name: 'Fixed Bridge',
    nameRo: 'Punte fixƒÉ',
    category: ProcedureCategory.PROSTHODONTICS,
    description: 'Element de punte ceramicƒÉ',
    defaultCost: 1200,
    insuranceCost: 600,
    estimatedDurationMinutes: 60,
    perTooth: true,
    tags: ['punte', 'proteticƒÉ']
  },

  // COSMETIC
  {
    id: 'proc-026',
    code: 'D9972',
    name: 'Teeth Whitening',
    nameRo: 'Albire dentarƒÉ profesionalƒÉ',
    category: ProcedureCategory.COSMETIC,
    description: 'Albire dentarƒÉ √Æn cabinet',
    defaultCost: 800,
    insuranceCost: 0,
    estimatedDurationMinutes: 90,
    commonlyUsed: true,
    tags: ['albire', 'estetic', 'cosmetic']
  },
  {
    id: 'proc-027',
    code: 'D2962',
    name: 'Veneer',
    nameRo: 'Fa»õetƒÉ ceramicƒÉ',
    category: ProcedureCategory.COSMETIC,
    description: 'Fa»õetƒÉ ceramicƒÉ esteticƒÉ',
    defaultCost: 1800,
    insuranceCost: 0,
    estimatedDurationMinutes: 60,
    perTooth: true,
    tags: ['fa»õetƒÉ', 'estetic', 'cosmetic']
  },

  // ORTHODONTICS
  {
    id: 'proc-028',
    code: 'D8070',
    name: 'Comprehensive Orthodontic Treatment',
    nameRo: 'Aparat dentar fix',
    category: ProcedureCategory.ORTHODONTICS,
    description: 'Tratament ortodontic complet cu aparat fix',
    defaultCost: 5000,
    insuranceCost: 2500,
    estimatedDurationMinutes: 60,
    tags: ['ortodon»õie', 'aparat', 'bretele']
  },
  {
    id: 'proc-029',
    code: 'D8090',
    name: 'Invisalign Treatment',
    nameRo: 'Tratament Invisalign',
    category: ProcedureCategory.ORTHODONTICS,
    description: 'Tratament cu gutiere transparente',
    defaultCost: 8000,
    insuranceCost: 0,
    estimatedDurationMinutes: 30,
    tags: ['ortodon»õie', 'invisalign', 'gutiere']
  },

  // EMERGENCY
  {
    id: 'proc-030',
    code: 'D9110',
    name: 'Emergency Treatment',
    nameRo: 'Tratament de urgen»õƒÉ durere',
    category: ProcedureCategory.EMERGENCY,
    description: 'Tratament paliativ pentru durere',
    defaultCost: 150,
    insuranceCost: 75,
    estimatedDurationMinutes: 30,
    commonlyUsed: true,
    tags: ['urgen»õƒÉ', 'durere']
  },
  {
    id: 'proc-031',
    code: 'D9230',
    name: 'Anesthesia',
    nameRo: 'Anestezie localƒÉ',
    category: ProcedureCategory.OTHER,
    description: 'Anestezie localƒÉ cu xilainƒÉ',
    defaultCost: 50,
    insuranceCost: 25,
    estimatedDurationMinutes: 5,
    tags: ['anestezie']
  }
];

// Helper functions
export function getProceduresByCategory(category: ProcedureCategory): ProcedureItem[] {
  return defaultProcedures.filter(proc => proc.category === category);
}

export function getCommonlyUsedProcedures(): ProcedureItem[] {
  return defaultProcedures.filter(proc => proc.commonlyUsed);
}

export function searchProcedures(query: string): ProcedureItem[] {
  const searchTerm = query.toLowerCase();
  return defaultProcedures.filter(proc => 
    proc.name.toLowerCase().includes(searchTerm) ||
    proc.nameRo?.toLowerCase().includes(searchTerm) ||
    proc.code.toLowerCase().includes(searchTerm) ||
    proc.tags?.some(tag => tag.toLowerCase().includes(searchTerm))
  );
}

export function calculateTotalCost(procedureIds: string[], useInsurancePrice = false): number {
  return procedureIds.reduce((total, id) => {
    const procedure = defaultProcedures.find(p => p.id === id);
    if (procedure) {
      const cost = useInsurancePrice && procedure.insuranceCost 
        ? procedure.insuranceCost 
        : procedure.defaultCost;
      return total + cost;
    }
    return total;
  }, 0);
}

export function calculateTotalDuration(procedureIds: string[]): number {
  return procedureIds.reduce((total, id) => {
    const procedure = defaultProcedures.find(p => p.id === id);
    return total + (procedure?.estimatedDurationMinutes || 0);
  }, 0);
}